(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(t,e,n){t.exports=n.p+"static/media/no_image.57f701ae.png"},39:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAQMHpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHja7ZtZduMwskT/cxW9BGIGloPxnLeDt/y+SVKy7PKg6bOtKlOWBBLIjIgMQITM//+/Jf/hJ2+bFx9SjiXGjR9ffLGVJ3k7fo6j2fz++/Jjzt+fXpfrU8vRcXTHG3GerSqvh48GyZ+vt8+vS+rHE5vPE12ufJ7Q6ZUtT87P5fNEzh6vm/NvKWe76m+Gc/5f3e5vh3a89fVvnwjGCJzPWbHTGbfxO+pVHD1wxdX9WJ1zxuqzyHPPX/o7fh87+Sl4P8Vuq+fr7nMoZIvnB+KXGJ2vm/B97PYI3fbIfFz50xt2mLnd/tzGbo281jxGV30kUlHOQV2Gsj/jg4TTu71Z5JH4H3ie9kfhkRliJ2ODbDYeXUwxlmgv480w1Swz92M3nS56O23iaG23bn8tu2SL7XsyvD7Mson0DHGZXHWy5njZXvti9uuW/XrdZK48DJ+0hpMZWvzzkO9efOZxPdFaCl1jtnyNFf2yimm6oZnT33yKhJh1xjTs8d0fcoOb7SaxjgyGPcyZAdatHadowXxgy+15dnwuwP7toIZJ4zwBIeLagc4YRwa2aFww0WzJ2mQMcczkp9Jz67xtZMCEAFZkkRvnIsnJVq9Nm2T2z9pgj5eRFhIRIEoiNRCIZHkfwE/yGQzV4IKXEEIMKeRQQo0u+hhijCmqRtXkkk8hxZRSTiXV7LLPIceccs4l12KLQ8JCiSVJyaWUWrlo5dSV1pVP1Npsc8230GJLLbfSagc+3ffQY08999LrsMMN6D/iSDLyKKNOM4HS9DPMONPMs8y6wNpyy6+w4korr7LqNWtnVj9nzXzJ3O9ZM2fWNGN+/1z6yBovp3Q5hVE5CZozMma9IeNJMwCgreZsy8Z7q5nTnG3FQopgyZoJmpxhNGNk0E9jwzLX3H1k7te8SfAP5c3+lDnR1L0jc6KpOzP3b96+ydqoe0Vxe4KUhRrTzS2EjQ/MNqybplEmzAiuJzdDrCFBZTTXDIpQa1zB8UmbNuda9t6hK/CECLi+WfHTJRNs84mTrBy16dpKny2v5GqBP3lstS9GPzi/cQwoWrONwtiIvOV6fpvCe7bX2Gbj9FuODHVaQpJydTluucDFZHqscBNp3cukqrXLnTqbbEJRVw5D5jbX1smIDXnmtvlG1ZuhGE2W67O4VMkcRZGANNdXzyaVzrlpFY3Xs5swl2giVnCNPva55rBbIxzFmTZNoXgCwqiSYWvSkECPblvnfEGJQjwKWXK9SWVkpdqBaDc3V3bOevJbMhUXnMyjzG8elxLBAPU61bp3QweSy+rOVC4i4K2X5vMIc1tWzz5DAFpgbFsA143heWd6NI6ebdEBl76oLpwIDAKasc04xDoMkuujJRAKxFUHEhVpbCtGUxzZQjI3n92yW8qzUVe0B9sK3UHBebYVO4BtzACDf2b0hIEgr3XFvhKnICq9jSOoCPCPR/n9AzAhk7sjDCShZ1g6qC3LxWmhQSlcH4wkCSm5UZTHM+7uD5hASPJxDGG50NHxuLleAdfahuJitqI4cUSrtr0Ey0rAYduKgVLrvHpYWcN8vbqtJHW/OlkIoEUvPshomhd7hq1JpMRADuJm4tIEtDw8UW4RNMQ0U2u5bzkkkDtxAYwDXM1l4gxUrlyXz80IVsINBxiBEc99tgiDQrorQbonD8X6gn2YG/6FrBsG44M6p44mZICLWDlp3a/JJ9KoVovdIOHZjxEqQ4p+zDUAWujIbUdU4N9MyAMWZOQDl3Cx+yyEw2lQTetArw40ZYxqTEmx+u7WiIQBh5lJCFWaTGGJ4Ar8hU/kgXazwbVWJpyfhDOoDML5UjdQXX0xPVdTwvAZjfcYOEID51MvZZnUVL8g3qaSGLrMggGaiTLeJ0BNOjCj3gmERkaAsHkTu+EcvEV4UMiFIdsjw8dJVF45Bak+oL0oQ0rBelSVHGOrVjlCt5wJMCZpJaEepbJImp+ZxFSbqxr94yiXJxiLpXE3QAeNIEx94DPr2lJpEX9na2+q/BO3Xc3sndMuhGH3HinKfpZFaHqC/0EVe0uUcKCAnwRURCRSSJoPnVDYbU6HC9SqlZoKC+ehYDSZE2Q4xbSnJfRNyDlQ6edZIIZdeFWHfsKdBqXRoK6yTBVmoGcP5KkuAIgw86cgyTVaPx5bhapWORS8XopTIc+ELkQ103VWkJfElqg9LitEynpGxvPsuNDtjsa3beW2sZtAbNsliIBtGpNtEjBkFv1tVOnmMOzLguI6lc3UEsrKZXaEvCMeZ+Itue14ACJ+dmDZ3geprzPVxilmp9Yue5njxD0GnKgeTz6Ok8JsFa0KW7ACbGsbmVKWSknB9B21kSnBKlVRC5zImlfYYooDrh3Yolo6bD0tYYbgK7SJO0mhhUWVLjOGCrsRLG+XVh8EHkXRGGkJZ0AjZLUfu8LZydFnJgPUvDgoF5FGQAMp6WlM3kMxXcITUr+N79FLWWNMvwYmJmy/ouB3CslfHLqXQvIXh+6lkPzFoXspJH9x6F7KyG+wf4Qy8lvjRygjXznzLGXkK2f+pczlWPHIacRVYywDJ78S5ZKqhQvHocpwjvpEEUPdg5ZzLRxmcm3qClTCV1GUcAIYvTJsZTLhGdWI4LN4DEDPfJS5CCN2RSc5WE2gzRTFMiEZnsl+3tyEE4fDI8gEiQoDBQjSIkidEutwwDpRMTJrpuzXsgdJ6yAGbzWn1hDrdqWDq40wU873irIxdTjZgIne2SCU892XZXXMmTyCvzaVwwcQgWHTnikQc2gVZx9PIEJfpQJYBYfSFMiwqSkSezoHcqHDdSAHHXQgR0XZx6EmETaow7SylZFfIP2V8/Ii6a+MkxdJf+W8vEj6aw/kR9LfVxevNJUX6+K1rVxJvj1ZGU+Wy8uV8WS1fE/3fuRsR+beQQd0yNk6O2irli7tIJN2px0U8JYhNJOHrD3062TY3sEBwyqm+OggStLODlrNGh1MC4qTLAPXpi757VfXACMv5Xp1SqNada7OFIOm+9Vt3gGjLp5/uE1KNbIgl/TENVc/Ls1UnSkysnKmZ9vTY0o8UkvHS7oBysFzeYLoO891MYFEX8VG7lObv8VGHujEr2Ij96nN32IjL7n0G7GRl1z6jdjISy79pgfyoEv/UVzkLQ6CtvKHg7hbXORNHsLK3R7iD3GR79XlcXGR79XFTX/RhzvlQT7pw4ONb9vKF3H5erzbVMiPYvOgrxH7Jl8j6U2+RuybfI38KjVnB5+kyPhrDsHx7OYNSuWBGrjj7HmKXGTsyGMqKmOrLXeMrjBFbd5HKEJGiZAb6tYj0kYyDgX4u/FtW7ltrHbrd/7fHN2plTuhNgw7OFqQ5YBsNLq4ZUbbStoYpVle11lznAPl0XR+yN2TdY1ScXWDZyc+9UH+7oSHICMdKf+Zf/JXqY/2vrDJG8zajhV5g1nb5VSelsQvciqveLXbo/xFz3v1Vu43d78rrtxv7n5XXLnf3P3OAbnX3P2qamBF3qJqAFXeomoIk7xF1Wgrz6nav0e5rj4e+T4MpnZjv9XhrDs5ku+WwtmNmfZuTF2v1174TF17vvEHYLV4yuNTR83fv2VT7p23/lU2/7fm/5Y1//vWOOQN05C9rby6kHlBirw8Cbl8dXjXJOTbY/+Ubnkw3+OwNPrtgla1PXa7ndAqsvoBXv1aAOtg0mkn8m4nTAmHnci6oFoXIf2OAXInBS6TnI8ufOmB/NoFv5fWu4Imb9C0va08rWlfkCIvK9oJU3lZ0c6SKc/7q3NGfZZ3eWal+LvyLs+sFH8HNXlmpfg7tZVnVoq/U1t5tgtf1VZeWTH+uuj79Irx7ZqOvLJifEsSeWXF+PYoL09CzjmIvDwJOecR8vIk5GwrD01CfrHxcudC8Z8zCXl4mfiHmYQ8vEz8g9LIw8vEPyiNPLxM/IPSyMPLxD8ojTy8TPzA12KfpOZeZZEf1MFdCiBdIabTX6ndkiGkSm3rqbM7tXs9V/24MrxLsz//ZZRsb7pNQ55fL/4sLfL8evFnaZHn14s/S4u80PjT+oY8vk78vdTI4+vE30vN01+LfZUaeZOrqfImV4MevcfV4EZedTW57/CVg+Dgd/rrQEIyEEwHUn3NaR/IrEdp3PJ+uwNJKem4idLoLUZJ3H6PUaHL05KHMhrs7muMrAuZgb50vV+wpD43s8aMG+/ttxjVFU105+0fUQZ/JbTwuP/DerfVOI/bPzbjo1cogdYW/ljZlFfNw4Xg8qp5uHBUXjUPl7by9Arml4VKeYXxt4SX/qbvoKW96TtoWW/6Dlou9xiFwYxxv8dIoTe93i9rxuowJ+c+g+5lMNEb3Xykm85Cb5SrjVI6AERsTEVtbWONPM57+vqg4Oq90cc9fQyil5aPe/qyzp33W/pSDdsWdM6Xtahm5rTT7tsCsi9I0YD35MA3zjN84jnTXd88HGurFCBdg95YODrYSOhDmnqzbKWu9ddr484ceUNt3Jkjb6iNe1t5Q23835r/G9f8FbyUvR252UenuK2LbvQ2A+hXDBeptO9jBt30YFOvpmwK3Kp1YwO43g1XdYNgmZwBw+j1tF7JRnkcvsbSZw5JSvfAkQAxtH1vZeiMliCbTUebnN4zHkxYUMNgNZPCI3TADZTHRt0z0xXrJBL5qVsQGaBuojAdTE0+sLi0brExaf9+zyXdlkRX06B4W2cp0NlrXiuu1nQ17NpYNwOMri3wznnUkJtumRlxeeru2jfOEKZtKgELRFUabLyn9yFmg4ykqLfbu9SW9/ve1tGcbk4KrfSkdwFTT/f9GgE3j3b15bvum4GwcwIK30Jepk2JZTKeaieMdZacG+Xv6vGyccbMphtnDMAKNThfgNa0rdnYs3Om+xoCTZkdhXzsvvH7biBdRbPbYFip6H4Xo24Bp7DvdyHkCSey7/fIgT7ySHgctJKhMQlZxegcQjd7nPtdUrhsFtGbQ2c6Glv8QUQtz80iGBWdQ/SWUhfdLIJSr/PqaJ2dzHauVx8tF7df3VhdYtWrx3Bstjnu93J5EUQJf2+X+e1oEGTd7pIkXLbsmLQiMrxv2dkauMtznDt28tIdO1AsHTt2iEXYdT6qnuqGl9ZEd7wEZEJ9ZRwTCpfQMoQlTKj/KPnYbrNz2muJDk0nUmccyELSHWZLfN7TkBXGIWLRAlEMpqcU0EQmo7tr1e27S/NDmo6dM7PozhljJkOAt0sWNo2XYSdTsc0ARMCrG0B0QxgCtDbawoFybJ1BldzwU3fOdGwvdJxzRN8pR7rPhGHnoZ3vboMGCqul96Hr5pnr1hm9057mKCaDTaMOdHAMm0re+EOqWUwXx6RUUy87etMpO64E3TqztD6jPn7B+6jqCh+7b3pBJrRUZPIfqVHq/HXrjtep7MF738nBWBQpYuHKYCo8qLSlJlNNKMtslYlztbqVq/cOowsSlnQhKvps+l6Ls1KLMmdXJCEOlUp+NPrTtpm9Re/KhqwFMIg9rzFwLt0HS6Soa/vkvOWakU+n1WqtgeWU/wLLVu0ZWBqlKAAAAAZiS0dEAJ4AngCed08JtwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+MBHwgrLs2rDOsAAAbnSURBVHja7d3NchXHAgRh1Xn/d5ZXDhOEAemgn5nOr/ZedFdl0sO9Qnv5xLy+vr4++99u24vIIbkqC7vSQclAAP+1LOzKhyUDAf7nsrC7HJYIBPgfz8LueGAiEOB/DAe764FJQMD/9yzs7gcmAQH/8yzshAOTgID/ORZ2yoGJQID/fg522qFJQMD/dg524qFJQMD/Ng526qFJQMD/Zw528qFJQMD/ew4eihTpbmalg3sJSB3+nxlYzXokIPU/+X9k4KFgke42Vj28l4CU4f93/w+FC/i7W3goXmygm7kEnwPg7+7+YQaGoPNuCMAgdF1+BbgMnwPg9wIQA9EtAYih6JQAxGB0SQCGYzg6JAADEt0RgCGJzgjAoERXBGBYoiMCMDDRDQEYmuiEAAxOdEEAhic6IAADFHdPAIYo7vyq8S8CfeRl+lFi8N9sr14AhumOfQKIgbpbAhBDdaepz9WHb1eDdZdeAGK47rD4EnDZX/fcEvBfbY9eAIbszrwAXLyXAPiLG/QCMGx35AWgBC8B8Bd3N2WQAPi7e5tSSAD83Z1NOSQA/u6+/CUgAJy9LAhFeQmAv7upKYwEwN/d0hRHAuDvbmgKJAHwd7czRZIA+LubmUJJAPzdrUyxJAD+7kamYBIAf3cbUzQJgL+7iSmcBMDf3cIUTwI20N3ADIAEdN/tfoZgCDrvdj6DMAhdd7ueYRiGjrsdz0AMRLfdbmcohqLTbqczGIPRZbdLf2oYjg7Dr7kv/3Y0oPsOSHfnfcr5yyND0lkU/m8TgEHda1C6OhP+bxWAYd1jWDo6F/5vF4CBXXtgujkb/ksIwNCuOTSdnA//ZQRgcNcanC4a8F9KAIZ3jeHpoAP/5QRggN87QHffgv+SAjDE7xmiO+/Bf1kBGOTXDtJdN+G/tAAMU8AfFwAJCPjjAiABAX9cACQg4I8LgAQE/HEBkICAPy4AEhDwxwVAAgL+uABIQMAfFwAJCPjjAiABAX9cACQg4I8LgAQE/HEBkICAPy4AEhDwxwVAAgL+uABIQMAfFwAJCPjjAiABAX9cACQg4I8LgAQE/HEBkICAPy4AEhDwxwVAAgL+uABIQOrw5wVAAlKGnwBIAPz1OzADEgA/AQgJgJ8AhATATwAkQALgJwASEPATAAkI+AmABAT8BEACAn4CIAEBPwGQgICfAEhAwE8AJCDgJwASEPATAAkI+AmABAT8BEACAn4CIAEBPwGQgID/Anm4AhEvAPGnv1cAAQj4SYAABPwkQAACfhIgAAE/CRCAgJ8ECAD84CcBAgC/kAABgF9IgADALyRAAOAXEiAA8AsJEAD4hQQIAPxCAgQAfiEBAgC/kAABgF9IgADALyRAAOAXEiAA8AsJEAD4hQQIAPxCAgQAfiEBAgC/kAABgF9IgADALyRAAOAXEiAA8AsJEAD4hQQIAPxCAlkBgF9IICoA8AsJRAUAfiGBqADALyQQFQD4hQSiAgC/kEBUAOAXEogKAPxCAlEBgF9IICoA8AsJRAUAfiGBqADALyQQFQD4hQSiAgC/kEBUAOD/umG6664EBn6DdOddCQz8hujuuxIY+A1QB10JDPyGp4uuBAZ+g9NJVwIDv6HppiuBgd/AdNSVwMBvWLrqSmDgNyiddSUw8BuS7roSGPgNSIddCQz8hqPLbpcGYzA6DXc6QzEU3Xa79b1oIDoOdzzDMAxdd7v2PxcZhM7Dnc8QDEH33e79v8XATwLhDUzx4CeB7hb8sAj4SSC8iSka/CTQ3YafFQc/CYQ3MsWCnwS6W/FPRYGfBMKbmSLBTwLd7fiXYsFPAuENTXHgJ4HulvyiCPCTQHhTUxT4SaC7rYcrAr+zh/fH0ADwEujubEoBPwl09+b3xIOfBMK7mxLATwLd/flLQPC7o/J9s69hewl0t+gFAH535gXAuIbsJVDcpRcA+N1hOA+WNVx3GReAGKw7bX5aEYChulsvADFQd5y8T9//hnnnJ6x4AYDfnQsBGKK7FwIwQB0IARieLoQADE4nQgCGphshAAPTkRCAYelKCMCgdEYArsCQdEcAYkA6JAAxHF0SgMEYjE4JwFBEt4ffycuLH600kFbs/b+9ewGAX9c+AQzCLeg8+wlQfhYZgs+B8u7TLwDwS30DD8ULCXS3kPzloOCX8udA+peDgl9s4xcvgNMtCH6pvwR+ZmCVCwC/1CXwfwwkPgHALzbzxk+A0wwIfvES+DUHO/nw4BcS+D0HO/Xw4BcS+DMHO/Hw4BcSeBsHO+nwwBcieB8LO+Xg4BcSeD8LO+Hg4BcSeI6F3f3w4BcSeJ6D3fXwwBci+HsWdrfDA1+I4ONY2B0uAPRCBJ/Dwq56CaAXQvh8Fv4BWEu9fS4FzJAAAAAASUVORK5CYII="},40:function(t,e,n){t.exports=n.p+"static/media/background.c8dead68.png"},44:function(t,e,n){t.exports=n(83)},45:function(t,e,n){},83:function(t,e,n){"use strict";n.r(e);var i={};n.r(i),n.d(i,"setPhotoViewer",function(){return E}),n.d(i,"setStatus",function(){return C});var r={};n.r(r),n.d(r,"setDimension",function(){return x});var a={};n.r(a),n.d(a,"confirm",function(){return I}),n.d(a,"message",function(){return D}),n.d(a,"showModalButton",function(){return B}),n.d(a,"hideModal",function(){return L});var o={};n.r(o),n.d(o,"cacheUrl",function(){return J}),n.d(o,"setSubView",function(){return X}),n.d(o,"backToHome",function(){return M}),n.d(o,"clearView",function(){return z}),n.d(o,"pushView",function(){return H}),n.d(o,"pullView",function(){return Q});var s={};n.r(s),n.d(s,"login",function(){return R}),n.d(s,"logout",function(){return T});var u={};n.r(u),n.d(u,"fetchReports",function(){return Y}),n.d(u,"submit",function(){return K}),n.d(u,"setCurrentStage",function(){return q}),n.d(u,"viewReport",function(){return _});n(45);var c=n(0),l=n.n(c),h=n(37),d=n.n(h),p=n(19);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var f=n(8),b=n.n(f),g=n(14),y=n(11),v=n(2),m=n(3),w=n(5),A=n(4),k=n(6),j=n(12),O=n(13),S=n.n(O),E=function(t){return{type:"setPhotoViewer",payload:t}},C=function(t){return{type:"setStatus",payload:t}},x=function(t){return{type:"setDimension",payload:t}},I=function(t,e,n){return{type:"confirm",payload:{message:t,onConfirm:e,onCancel:n}}},D=function(t){return{type:"message",payload:t}},B=function(){return{type:"showModalButton"}},L=function(){return{type:"hideModal"}},J=function(t,e){return{type:"cacheUrl",payload:{filename:t,url:e}}},X=function(t){return{type:"setSubView",payload:t}},M=function(){return{type:"backToHome"}},z=function(){return{type:"clearView"}},H=function(t){return{type:"pushView",payload:t}},Q=function(){return{type:"pullView"}};function V(t){t({type:"loadingMessage",payload:["Connecting...","\u9023\u7dda\u4e2d...","\u8fde\u7ebf\u4e2d..."]})}function G(t){t({type:"message",payload:["Connection error, Please try again!","\u7db2\u7d61\u51fa\u73fe\u554f\u984c\uff0c\u8acb\u518d\u8a66\u4e00\u6b21!","\u7f51\u7edc\u51fa\u73b0\u95ee\u9898\uff0c\u8bf7\u518d\u8bd5\u4e00\u6b21!"]})}function P(t){return t.then(function(t){return[null,t]}).catch(function(t){return[t]})}var U=P,W="https://sitetracker.io";function R(t,e){return console.log(W),console.log(t+" "+e),function(){var t=Object(y.a)(b.a.mark(function t(e){var n,i,r,a;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return V(e),t.next=3,U(S.a.get(W+"/user/login",{headers:{id:"abc",pw:"123"}}));case 3:if(r=t.sent,a=Object(g.a)(r,2),n=a[0],i=a[1],!n){t.next=10;break}return G(e),t.abrupt("return");case 10:"succeed"===i.data.result?(console.log(i.data),e({type:"setUser",payload:i.data.user}),e({type:"setStatus",payload:"ready"}),e({type:"hideModal"})):e({type:"message",payload:["Login failed! Invalid id or password!","\u767b\u5165\u5931\u6557! \u540d\u7a31\u6216\u5bc6\u78bc\u4e0d\u6b63\u78ba!","\u767b\u5165\u5931\u8d25! \u540d\u79f0\u6216\u5bc6\u7801\u4e0d\u6b63\u786e!"]});case 11:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}function T(){return function(t){window.location.reload()}}var Z=n(1),F=P,N="https://sitetracker.io";function Y(){return function(){var t=Object(y.a)(b.a.mark(function t(e){var n,i,r,a;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F(S.a.get(N+"/report/fetchAll"));case 2:if(r=t.sent,a=Object(g.a)(r,2),n=a[0],i=a[1],!n){t.next=9;break}return G(e),t.abrupt("return");case 9:"succeed"===i.data.result?e({type:"updateReports",payload:i.data.reports}):G(e);case 10:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}function K(t,e,n){return function(){var i=Object(y.a)(b.a.mark(function i(r){var a,o,s,u,c,l,h,d,p,f,y,v,m,w,A;return b.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return V(r),(a=new FormData).append("files",e,"photo.png"),(o=new FormData).append("files",n,"signature.png"),i.next=7,F(S.a.post(N+"/upload",a,{headers:{type:"photo"}}));case 7:if(h=i.sent,d=Object(g.a)(h,2),s=d[0],u=d[1],!s){i.next=14;break}return G(r),i.abrupt("return");case 14:return i.next=16,F(S.a.post(N+"/upload",o,{headers:{type:"signature"}}));case 16:if(p=i.sent,f=Object(g.a)(p,2),s=f[0],c=f[1],!s){i.next=23;break}return G(r),i.abrupt("return");case 23:return y=u.data.filenames[0],v=c.data.filenames[0],m=Object(Z.a)({},t,{photo:y,signature:v}),i.next=28,F(S.a.post(N+"/report/add",{data:{report:m,latitude:t.geoLocated.latitude,longitude:t.geoLocated.longitude}}));case 28:if(w=i.sent,A=Object(g.a)(w,2),s=A[0],l=A[1],!s){i.next=35;break}return G(r),i.abrupt("return");case 35:"succeed"===l.data.result?(r({type:"hideModal"}),r({type:"updateReports",payload:[l.data.report]}),r({type:"viewReport",payload:{submitted:!0}}),r({type:"setCurrentStage",payload:4})):(console.log(l.data.result),r({type:"message",payload:["Submit failed! Please try again!","\u63d0\u4ea4\u5931\u6557! \u8acb\u518d\u8a66\u4e00\u6b21!","\u63d0\u4ea4\u5931\u8d25! \u8bf7\u518d\u8bd5\u4e00\u6b21!"]}));case 36:case"end":return i.stop()}},i,this)}));return function(t){return i.apply(this,arguments)}}()}var q=function(t){return{type:"setCurrentStage",payload:t}},_=function(t){return{type:"viewReport",payload:t}},$=function(){function t(e){Object(v.a)(this,t),this.init(e)}return Object(m.a)(t,[{key:"init",value:function(t){this.func=t.functions,this.actions=t.actions}},{key:"getUrl",value:function(){var t=Object(y.a)(b.a.mark(function t(e,n){var i;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.func.url(e,n);case 2:if(i=t.sent,this.unmounted||!i||i===this.url){t.next=10;break}if(this.url=i,!this.useBlob){t.next=9;break}return t.next=8,this.urlToBlob(i);case 8:this.blob=t.sent;case 9:this.actions.main.setStatus("ready");case 10:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"urlToBlob",value:function(){var t=Object(y.a)(b.a.mark(function t(e){var n,i;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",null);case 2:return t.next=4,fetch(e).catch(function(t){return null});case 4:return n=t.sent,t.next=7,n.blob().catch(function(t){return null});case 7:return i=t.sent,t.abrupt("return",i);case 9:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.unmounted=!0}}]),t}(),tt=n(39),et=n.n(tt),nt=function(){function t(e){Object(v.a)(this,t),this.init(e)}return Object(m.a)(t,[{key:"init",value:function(t){this.app=t,this.ui=t.store.ui,this.bs=this.ui.basicStyle,this.func=t.functions,this.actions=t.actions}},{key:"rectGreen",value:function(t,e,n){var i={width:e[0],height:e[1],background:"linear-gradient(to bottom, #008901 0%, #91c33b 100%)",color:"white",fontWeight:"bold",fontSize:"100%",borderStyle:"solid",borderWidth:"1px",borderColor:"#008901"};return this.button(i,t,"",n,"rectGreen")}},{key:"absoluteClose",value:function(t){var e={width:.04*this.bs.height,height:.04*this.bs.height,margin:.015*this.bs.width,position:"absolute",top:0,right:0,opacity:.25};return this.button(e,["",""],et.a,t)}},{key:"standard",value:function(t,e,n){var i={width:.135*this.bs.height,height:.065*this.bs.height,background:t,color:"white",fontWeight:"normal",fontSize:"100%"};return this.button(i,e,"",n,"standard"+e)}},{key:"button",value:function(t,e,n,i,r){var a=Object(Z.a)({},it.button,t);return n&&""!==n&&(a=Object(Z.a)({},a,{backgroundImage:"url("+n+")"})),l.a.createElement("button",{style:a,key:r,onClick:i},this.func.multiLang(e[0],e[1],e[2]))}}]),t}(),it={button:{border:"none",cursor:"pointer",backgroundSize:"100% 100%",backgroundColor:"transparent",fontWeight:"bold",fontSize:"100%",color:"white",flexShrink:0,position:"relative"}},rt=nt,at=function(){function t(e){Object(v.a)(this,t),this.init(e)}return Object(m.a)(t,[{key:"init",value:function(t){this.app=t,this.ui=t.store.ui,this.bs=this.ui.basicStyle,this.func=t.functions}},{key:"optionBar",value:function(t,e,n,i,r){var a={width:e[0],height:e[1],fontSize:"125%",display:"flex",flexFlow:"row nowrap",justifyContent:"center",backgroundColor:"white",flexShrink:0};return l.a.createElement("select",{id:t,style:a,defaultValue:i,onChange:r?function(t){r(t)}:null},n.map(function(t,e){return l.a.createElement("option",{key:e},t)}))}},{key:"dateField",value:function(t,e,n){return l.a.createElement("input",{id:t,type:e,defaultValue:n,style:{width:"50%",height:"4%",fontSize:"100%",margin:"2%",flexShrink:0}})}},{key:"textArea",value:function(t,e,n,i,r,a){var o={width:r?r[0]:.67*this.bs.width,height:r?r[1]:.15*this.bs.height,fontSize:a||"175%",flexShrink:0};return l.a.createElement("textarea",{id:t,style:o,defaultValue:n,onChange:i||null,placeholder:e?this.func.multiLang(e[0],e[1],e[2]):""})}},{key:"inputField",value:function(t,e,n,i,r,a){var o={width:i[0],height:i[1],fontSize:i[1],color:this.ui.colors.grey,flexShrink:0};return l.a.createElement("input",{id:t,type:e,style:o,placeholder:this.func.multiLang(n[0],n[1],n[2]),defaultValue:r,onChange:a})}}]),t}(),ot=function(t){function e(){var t,n;Object(v.a)(this,e);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(n=Object(w.a)(this,(t=Object(A.a)(e)).call.apply(t,[this].concat(r)))).url=new $(n.props.app),n.buttons=new rt(n.props.app),n.inputs=new at(n.props.app),n}return Object(k.a)(e,t),Object(m.a)(e,[{key:"componentWillReceiveProps",value:function(t){this.init(t),this.checkUrl()}},{key:"checkUrl",value:function(){this.state&&this.state.filename&&this.url.getUrl(this.state.filename,this.state.type)}},{key:"init",value:function(t){this.app=t.app,this.ui=this.app.store.ui,this.bs=this.ui.basicStyle,this.store=this.app.store,this.func=this.app.functions,this.db=this.app.database,this.actions=this.app.actions,this.url.init(t.app)}},{key:"textDisplay",value:function(t,e,n,i,r,a){var o={width:e?e[0]:"100%",height:e?e[1]:"",margin:"1%",fontSize:n||"100%",fontWeight:"normal",textAlign:i||"left",overflow:"hidden",overflowWrap:"break-word",color:r||this.ui.colors.textGrey,flexShrink:0};return l.a.createElement("div",{key:a||"defaultKey"+t,style:o},t)}},{key:"gap",value:function(t){return l.a.createElement("div",{style:{height:t,width:"100%",flexShrink:0}})}},{key:"sep",value:function(){return l.a.createElement("div",{style:{height:"1px",width:"100%",backgroundColor:"black",opacity:.15,flexShrink:0}})}},{key:"verGap",value:function(t){return l.a.createElement("div",{style:{minWidth:t,height:"100%",flexShrink:0}})}},{key:"verSep",value:function(t,e){return l.a.createElement("div",{style:{backgroundColor:t,width:"1px",height:e,flexShrink:0}})}}]),e}(c.Component),st=function(t){function e(){return Object(v.a)(this,e),Object(w.a)(this,Object(A.a)(e).apply(this,arguments))}return Object(k.a)(e,t),Object(m.a)(e,[{key:"title",value:function(){var t={color:this.ui.colors.green,fontSize:.1*this.bs.height,fontWeight:"bold"};return l.a.createElement("div",{style:t},"SiteTracker")}},{key:"render",value:function(){var t=this;this.init(this.props);var e=[.35*this.bs.width,.035*this.bs.width];return l.a.createElement("div",{style:Object(Z.a)({},this.bs,{justifyContent:"center"})},this.title(),this.gap("6%"),this.inputs.inputField("id","text",["Login id","\u767b\u5165\u540d\u7a31"],e),this.gap("3%"),this.inputs.inputField("pw","password",["Password","\u5bc6\u78bc"],e),this.gap("6%"),this.buttons.rectGreen(["Login","\u767b\u5165"],e,function(){t.login()}))}},{key:"login",value:function(t,e){var n=t||document.getElementById("id").value,i=e||document.getElementById("pw").value;this.props.app.actions.user.login(n,i)}}]),e}(ot),ut=n(7),ct=function(t){function e(t){var n;return Object(v.a)(this,e),(n=Object(w.a)(this,Object(A.a)(e).call(this,t))).init(t),n.state={},n}return Object(k.a)(e,t),Object(m.a)(e,[{key:"componentWillReceiveProps",value:function(t){this.checkViewTransition(t)}},{key:"checkViewTransition",value:function(t){this.state&&this.setState({view:t.app.store.content.subView,deadView:this.state.view!==t.app.store.content.subView?this.state.view:this.state.deadView})}},{key:"animatedView",value:function(t,e,n,i){var r=this,a=i||{stiffness:100,damping:50,precision:3};return l.a.createElement(ut.Motion,{key:e,defaultStyle:{opacity:n?0:1},style:{opacity:n?Object(ut.spring)(1,a):Object(ut.spring)(0,a)},onRest:n?null:function(){r.setState({deadView:null})}},function(n){return t(e,n)})}},{key:"animatedSubView",value:function(t,e,n){return this.animatedView(t,e,n,{stiffness:1e3,damping:50,precision:9})}},{key:"viewStyle",value:function(){return Object(Z.a)({},this.bs,{height:1*this.bs.height,position:"relative",justifyContent:"flex-start",alignItems:"center",overflowY:"auto",backgroundColor:"white",opacity:this.app.animatedStyle.opacity,pointerEvents:1===this.app.animatedStyle.opacity?"":"none"})}},{key:"viewContentStyle",value:function(){return{width:"100%",display:"flex",flexFlow:"column nowrap",flexShrink:0,justifyContent:"flex-start",alignItems:"center",overflowY:"auto",backgroundColor:"white"}}}]),e}(ot),lt=n(18),ht=n.n(lt),dt=function(t){function e(t){var n;return Object(v.a)(this,e),(n=Object(w.a)(this,Object(A.a)(e).call(this,t))).content=function(t){return l.a.createElement("div",{style:Object(Z.a)({},n.rowStyle(),{height:t.height,opacity:t.opacity*n.outDated?.5:1})},n.lastModified(),n.description(),n.submitTime(),n.category(),n.subCategory(),n.verSep(n.ui.colors.lightGrey,"75%"),n.region(),n.status(),n.coordinate(),n.verSep(n.ui.colors.lightGrey,"75%"),n.reporter(),n.signature())},n.init(t),n.state={filename:n.props.report?n.props.report.photo[0]:null,type:"photo"},n.checkUrl(),n}return Object(k.a)(e,t),Object(m.a)(e,[{key:"componentWillReceiveProps",value:function(t){this.init(t),t.report&&!this.state.filename&&this.setState({filename:t.report.photo,type:"photo"}),this.checkUrl()}},{key:"rowInfo",value:function(){var t=this.props.report,e=Object(Z.a)({},this.ui.styles.area,{width:"100%",height:.06*this.bs.height,justifyContent:"flex-start",alignItems:"flex-end"});return l.a.createElement("div",{style:e},this.textDisplay(this.func.dateString(new Date(t.createdAt)),["",""],"150%","",this.ui.colors.lightGrey))}},{key:"render",value:function(){return null===this.props.report?null:this.animatedRow(this.content.bind(this),.2*this.bs.height)}},{key:"text",value:function(t){return this.textDisplay(t,["100%",.035*this.bs.height],.025*this.bs.height,"center",this.ui.colors.textGrey)}},{key:"itemStyle",value:function(t){return Object(Z.a)({},this.bs,{width:t||.15*this.bs.width,height:.2*this.bs.height,justifyContent:"flex-start",marginTop:"1%"})}},{key:"lastModified",value:function(){var t=this;return l.a.createElement("div",{style:this.itemStyle(.16*this.bs.width)},this.rowIcon(null,function(){t.actions.main.setPhotoViewer(0),t.actions.report.viewReport(t.props.report)}),this.gap("5%"),this.text(this.func.dateString(new Date(this.props.report.createdAt))))}},{key:"description",value:function(){return l.a.createElement("div",{style:this.itemStyle()},this.text(this.props.report.description))}},{key:"submitTime",value:function(){return l.a.createElement("div",{style:this.itemStyle()},this.text(this.func.dateString(new Date(this.props.report.createdAt))),this.text(this.func.timeString(new Date(this.props.report.createdAt))))}},{key:"category",value:function(){return l.a.createElement("div",{style:this.itemStyle()},this.text(this.props.report.catagory))}},{key:"subCategory",value:function(){return l.a.createElement("div",{style:this.itemStyle()},this.text(this.props.report.problem))}},{key:"region",value:function(){return l.a.createElement("div",{style:this.itemStyle()},this.text("region"))}},{key:"status",value:function(){return l.a.createElement("div",{style:this.itemStyle()},this.text("status"))}},{key:"coordinate",value:function(){return l.a.createElement("div",{style:this.itemStyle()},this.text(Math.round(100*this.props.report.geoLocated.latitude)/100),this.text(Math.round(100*this.props.report.geoLocated.longitude)/100))}},{key:"reporter",value:function(){return l.a.createElement("div",{style:this.itemStyle()},this.text("reporter"))}},{key:"signature",value:function(){return l.a.createElement("div",{style:this.itemStyle()},this.text("provided"))}}]),e}(function(t){function e(){return Object(v.a)(this,e),Object(w.a)(this,Object(A.a)(e).apply(this,arguments))}return Object(k.a)(e,t),Object(m.a)(e,[{key:"alertTag",value:function(){var t={width:.04*this.bs.height,height:.04*this.bs.height};return l.a.createElement("div",{style:t},this.animatedAlert())}},{key:"rowContent",value:function(t,e){var n=Object(Z.a)({},this.bs,{width:"75%",height:.12*this.bs.height,marginLeft:.02*this.bs.height});return l.a.createElement("div",{style:n},this.rowTitle(t),e())}},{key:"rowTitle",value:function(t){if(!t)return null;var e={width:"100%",height:.06*this.bs.height,fontWeight:"bold",fontSize:.04*this.bs.width,textAlign:"left",color:this.ui.colors.textGrey};return l.a.createElement("div",{style:e},t)}},{key:"rowIcon",value:function(t,e){var n=.12*this.bs.height,i=.11*this.bs.height,r=Object(Z.a)({},this.ui.styles.button,this.ui.styles.container,this.ui.styles.border,{width:n,height:n,backgroundColor:"white",position:"relative",borderRadius:5}),a=Object(Z.a)({},this.ui.styles.border,{maxWidth:i,maxHeight:i,backgroundColor:"white"}),o=t||(this.url.url?this.url.url:ht.a);return l.a.createElement("div",{style:r,onClick:e},l.a.createElement("img",{key:o,style:a,src:o,alt:""}))}},{key:"animatedRow",value:function(t,e,n){var i={stiffness:n?200:300,damping:26,precision:1.2};return l.a.createElement(ut.Motion,{defaultStyle:{height:n?e:0,opacity:n?1.1:0},style:{height:Object(ut.spring)(n?0:e,i),opacity:Object(ut.spring)(n?0:1.1,i)}},function(e){return t(e)})}},{key:"animatedFadingRow",value:function(t,e){return l.a.createElement(ut.Motion,{defaultStyle:{opacity:0},style:{opacity:Object(ut.spring)(e?1:.25,{stiffness:1e3,damping:50,precision:2})}},function(e){return t(e)})}},{key:"rowStyle",value:function(){return Object(Z.a)({},this.ui.styles.area,this.ui.styles.border,{flexShrink:0,width:"98%",alignItems:"center",position:"relative",borderRadius:5,margin:"1%"})}}]),e}(ot)),pt=function(t){function e(){return Object(v.a)(this,e),Object(w.a)(this,Object(A.a)(e).apply(this,arguments))}return Object(k.a)(e,t),Object(m.a)(e,[{key:"componentDidMount",value:function(){this.actions.report.fetchReports()}},{key:"topBar",value:function(){var t=Object(Z.a)({},this.ui.styles.area,{width:this.bs.width,height:.1*this.bs.height,backgroundColor:"transparent",alignItems:"center"});return l.a.createElement("div",{style:t},this.verGap("5%"),this.inputs.inputField("search","text","",[.5*this.bs.width,.025*this.bs.height],"",function(){}),this.verGap("30%"),this.buttons.standard(this.ui.colors.blue,["Export .csv","\u6c47\u51fa .csv",""],function(){}))}},{key:"table",value:function(){var t=Object(Z.a)({},this.bs,{width:this.bs.width,height:.9*this.bs.height,backgroundColor:"transparent"});return l.a.createElement("div",{style:t},this.tableBar(),this.reportRows())}},{key:"tableBar",value:function(){var t=Object(Z.a)({},this.ui.styles.area,{width:this.bs.width,height:.1*this.bs.height,backgroundColor:this.ui.colors.deepBlue});return l.a.createElement("div",{style:t},this.tableBarItems())}},{key:"tableBarItems",value:function(){var t=Object(Z.a)({},this.ui.styles.area,{alignItems:"center",justifyContent:"center",width:"100%",fontSize:.01*this.bs.width,color:"white"});return["Last Modified","Description","Submit Time","Category","Sub-Category","Region","Status","Coordinate","Reporter","Signature"].map(function(e,n){return l.a.createElement("div",{key:n,style:t},e)})}},{key:"reportRows",value:function(){var t=this,e=Object(Z.a)({},this.bs,{width:this.bs.width,height:.8*this.bs.height,overflow:"auto"});return l.a.createElement("div",{style:e},this.store.report.reports.map(function(e,n){return l.a.createElement(dt,{index:n,app:t.app,report:e})}))}},{key:"render",value:function(){return this.init(this.props),l.a.createElement("div",{style:this.viewStyle()},this.topBar(),this.table())}}]),e}(ct),ft=function(t){function e(t){var n;return Object(v.a)(this,e),(n=Object(w.a)(this,Object(A.a)(e).call(this,t))).init(t),n.state={filename:t.filename,type:t.type},n.checkUrl(),n}return Object(k.a)(e,t),Object(m.a)(e,[{key:"componentWillReceiveProps",value:function(t){var e=this;this.init(t);var n=t.filename;this.state.filename!==n&&this.setState({filename:n},function(){e.checkUrl()}),this.checkUrl()}},{key:"render",value:function(){var t=this;this.init(this.props);var e=this.props.photoUrl?this.props.photoUrl:this.url.url,n=this.props.size?this.props.size:"100%",i=this.props.scale,r=Object(Z.a)({},this.ui.styles.container,{width:this.props.size?n:i[0],height:this.props.size?n:i[1],backgroundColor:this.props.backgroundColor?this.props.backgroundColor:"transparent"}),a=e?null:ht.a,o=this.props.size?.95*n:"95%",s=Object(Z.a)({},this.ui.styles.container,{width:o,height:o,backgroundImage:"url("+a+")"}),u=Object(Z.a)({},this.ui.styles.button,{width:this.props.size?n:i[0],height:this.props.size?n:i[1],position:"absolute",opacity:0});return l.a.createElement("div",{key:e,style:r},l.a.createElement("div",{style:s},l.a.createElement("img",{style:{maxWidth:n,maxHeight:n},src:e,alt:""}),null!==e&&this.buttons.button(u,["",""],"",this.props.noEnlarge?null:function(){t.onImageClick()})))}},{key:"onImageClick",value:function(){this.props.onClick&&this.props.onClick(),this.props.photoUrl||this.url.url}}]),e}(ot),bt=function(t){function e(){return Object(v.a)(this,e),Object(w.a)(this,Object(A.a)(e).apply(this,arguments))}return Object(k.a)(e,t),Object(m.a)(e,[{key:"photoSelectBar",value:function(){var t=this,e=Object(Z.a)({},this.ui.styles.area,{width:this.bs.width,height:.15*this.bs.height}),n=this.store.report.viewingReport;return l.a.createElement("div",{style:e},n.photo&&n.photo.map(function(e,n){return l.a.createElement(ft,{app:t.app,filename:e,type:"photo",scale:[.25*t.bs.width,.15*t.bs.height],onClick:function(){t.actions.main.setPhotoViewer(n)}})}))}},{key:"render",value:function(){var t=this;this.init(this.props);var e=this.store.main.photoViewer,n="off"!==e,i=this.store.report.viewingReport,r="off"===e?0:e,a=Object(Z.a)({},this.bs,{position:"absolute",width:this.bs.width,height:this.bs.height,minHeight:this.bs.minHeight,backgroundColor:"rgba(0,0,0,0.9)",opacity:1,pointerEvents:n?"auto":"none"});return l.a.createElement(ut.Motion,{defaultStyle:{opacity:0},style:{opacity:n?Object(ut.spring)(1.5):Object(ut.spring)(0)}},function(n){return l.a.createElement("div",{key:e+t.count,style:Object(Z.a)({},a,{opacity:n.opacity})},i.photo&&l.a.createElement(ft,{app:t.app,filename:i.photo[r],type:"photo",scale:[.8*t.bs.width,.8*t.bs.height]}),t.photoSelectBar(),t.buttons.absoluteClose(function(){t.actions.main.setPhotoViewer("off")}))})}}]),e}(ot),gt=function(t){function e(){return Object(v.a)(this,e),Object(w.a)(this,Object(A.a)(e).apply(this,arguments))}return Object(k.a)(e,t),Object(m.a)(e,[{key:"componentDidMount",value:function(){this.actions.content.pushView("entry")}},{key:"componentWillReceiveProps",value:function(t){this.setState({view:t.app.store.content.view,deadView:this.state.view!==t.app.store.content.view?this.state.view:this.state.deadView})}},{key:"views",value:function(t,e){var n=this.app;if(n.animatedStyle=e,""===t)return null;switch(t){case"entry":return l.a.createElement(pt,{app:n});default:return null}}},{key:"render",value:function(){this.init(this.props);var t=Object(Z.a)({},this.ui.basicStyle,{justifyContent:"flex-start",background:"transparent",backgroundSize:"100% 100%",position:"relative",backgroundColor:"white"}),e=this.state.deadView,n=this.state.view;return l.a.createElement("div",{style:t},this.animatedView(this.views.bind(this),e||n,!e),l.a.createElement(bt,{app:this.app}))}}]),e}(ct),yt=function(t){function e(){return Object(v.a)(this,e),Object(w.a)(this,Object(A.a)(e).apply(this,arguments))}return Object(k.a)(e,t),Object(m.a)(e,[{key:"page",value:function(){var t=this.props.app;switch(t.store.main.status){case"waitForLogin":return l.a.createElement(st,{app:t});case"ready":return l.a.createElement(gt,{app:t});default:return l.a.createElement("div",null)}}},{key:"render",value:function(){return l.a.createElement("div",{style:this.bs},this.page())}}]),e}(c.Component),vt=function(t){function e(){return Object(v.a)(this,e),Object(w.a)(this,Object(A.a)(e).apply(this,arguments))}return Object(k.a)(e,t),Object(m.a)(e,[{key:"componentDidMount",value:function(){this.count=0}},{key:"componentWillReceiveProps",value:function(t){this.count=this.count+1}},{key:"board",value:function(){var t={width:.4*this.bs.height,height:.2*this.bs.height,borderRadius:"20px",backgroundImage:"",backgroundSize:"100% 100%",display:"flex",flexFlow:"column nowrap",alignItems:"center",justifyContent:"flex-end"};return l.a.createElement("div",{style:t},l.a.createElement("div",{style:{height:"10%"}}),this.message(),this.buttonsArea())}},{key:"message",value:function(){var t=this.store.modal[this.store.main.language];return l.a.createElement("div",{style:mt},t)}},{key:"buttonsArea",value:function(){var t=this,e=this.store.modal.button,n="off"!==e,i="confirm"===e?this.store.modal.onConfirm:function(){},r=this.store.modal.onCancel?this.store.modal.onCancel:function(){};return l.a.createElement("div",{style:{width:"85%",height:"65%",backgroundColor:"transparent",display:"flex",flexFlow:"row nowrap",justifyContent:"space-around",alignItems:"center",flexShrink:0}},n&&this.button(["Confirm","\u78ba\u5b9a","\u786e\u5b9a"],function(){i(),t.actions.modal.hideModal()}),"confirm"===e&&this.button(["Cancel","\u53d6\u6d88","\u53d6\u6d88"],function(){r(),t.actions.modal.hideModal()}))}},{key:"button",value:function(t,e){return this.buttons.button(mt,t,"",e)}},{key:"render",value:function(){var t=this;this.init(this.props);var e=this.store.modal.status,n="off"!==e,i={position:"absolute",width:this.bs.width,height:this.bs.height,minHeight:this.bs.minHeight,backgroundColor:"rgba(0,0,0,0.5)",opacity:1,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:n?"auto":"none"};return l.a.createElement(ut.Motion,{defaultStyle:{opacity:0},style:{opacity:n?Object(ut.spring)(1.5):Object(ut.spring)(0)}},function(n){return l.a.createElement("div",{key:e+t.count,style:Object(Z.a)({},i,{opacity:n.opacity})},t.board())})}}]),e}(ot),mt={borderRadius:"20px",backgroundColor:"rgba(255,255,255,0.9)",color:"black",fontFamily:"adobestdb",fontSize:"100%",fontWeight:"bold",textAlign:"center",padding:"5%",writingMode:"horizontal-lr"},wt=vt,At=n(40),kt=n.n(At),jt=function(t){function e(){return Object(v.a)(this,e),Object(w.a)(this,Object(A.a)(e).apply(this,arguments))}return Object(k.a)(e,t),Object(m.a)(e,[{key:"componentDidMount",value:function(){this.init(this.props),this.actions.main.setStatus("ready")}},{key:"componentWillReceiveProps",value:function(t){this.init(this.props)}},{key:"render",value:function(){this.init(this.props);var t={width:.9999*this.ui.windowWidth,height:.9999*this.ui.windowHeight,minHeight:this.bs.height,backgroundImage:"url("+kt.a+")",backgroundSize:"10% 10%",display:"flex",flexFlow:"row nowrap",justifyContent:"center",boxSizing:"border-box",overflow:"hidden"};return l.a.createElement("div",{style:t},l.a.createElement(yt,{app:this.app}),l.a.createElement(wt,{app:this.app}))}}]),e}(ot),Ot=function(t){function e(){return Object(v.a)(this,e),Object(w.a)(this,Object(A.a)(e).apply(this,arguments))}return Object(k.a)(e,t),Object(m.a)(e,[{key:"api",value:function(){return this.isDev()?"http://localhost:3000":"https://sitetracker.io"}},{key:"isDev",value:function(){return!1}},{key:"addZeroIfSingle",value:function(t){return t<10?"0"+String(t):""+String(t)}},{key:"dateString",value:function(t){var e=t.getFullYear(),n=t.getMonth()+1,i=t.getDate();t.getHours(),t.getMinutes();return e+"-"+this.addZeroIfSingle(n)+"-"+this.addZeroIfSingle(i)}},{key:"timeString",value:function(t){var e=t.getHours(),n=t.getMinutes();return this.addZeroIfSingle(e)+":"+this.addZeroIfSingle(n)}},{key:"multiLang",value:function(t,e,n){switch(this.props.store.main.language){case"english":return t;case"chinese":return e;case"simplified_chinese":return n;default:return t}}},{key:"url",value:function(){var t=Object(y.a)(b.a.mark(function t(e,n){var i,r,a,o,s,u,c,l,h,d;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.props.actions.content,e){t.next=3;break}return t.abrupt("return","");case 3:if(!(r=this.props.store.content.cachedUrl[e])){t.next=9;break}if("processing..."!==r){t.next=8;break}return t.abrupt("return","");case 8:return t.abrupt("return",r);case 9:return i.cacheUrl(e,"processing..."),t.next=12,this.props.db.get(e);case 12:if(!(a=t.sent)){t.next=19;break}return o=URL.createObjectURL(a),i.cacheUrl(e,o),t.abrupt("return",o);case 19:return s=this.api()+"/download/"+n+"/"+e,t.next=22,S.a.get(s,{responseType:"blob"}).then(function(t){return[null,t]}).catch(function(t){return[t]});case 22:if(l=t.sent,h=Object(g.a)(l,2),u=h[0],c=h[1],!u&&c.data){t.next=29;break}return console.log("file download error!"),t.abrupt("return","");case 29:return this.props.db.set(e,c.data),d=URL.createObjectURL(c.data),i.cacheUrl(e,d),t.abrupt("return",d);case 33:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t={store:this.props.store,actions:this.props.actions,database:this.props.db,functions:{url:this.url.bind(this),multiLang:this.multiLang.bind(this),dateString:this.dateString.bind(this),timeString:this.timeString.bind(this)}};return l.a.createElement(jt,{app:t})}},{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions.bind(this))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions.bind(this))}},{key:"updateWindowDimensions",value:function(){this.props.actions.ui.setDimension({width:window.innerWidth,height:window.innerHeight})}}]),e}(c.Component);function St(t,e){return Object(j.b)(t,e)}var Et=Object(p.b)(function(t,e){return{store:t}},function(t){return{actions:{main:St(i,t),ui:St(r,t),modal:St(a,t),content:St(o,t),user:St(s,t),report:St(u,t)}}})(Ot),Ct=n(41),xt=n.n(Ct),It=function(){function t(){Object(v.a)(this,t),this.dbPromise=xt.a.open("database",1,function(t){t.createObjectStore("store")}),this.get=this.get.bind(this),this.set=this.set.bind(this),this.delete=this.delete.bind(this),this.clear=this.clear.bind(this)}return Object(m.a)(t,[{key:"get",value:function(t){var e=this;return this.dbPromise.then(function(e){return e.transaction("store").objectStore("store").get(t)}).catch(function(t){console.log("db error, clearing db..."),e.clear()})}},{key:"set",value:function(t,e){return this.dbPromise.then(function(n){var i=n.transaction("store","readwrite");return i.objectStore("store").put(e,t),i.complete})}},{key:"delete",value:function(t){return this.dbPromise.then(function(e){var n=e.transaction("store","readwrite");return n.objectStore("store").delete(t),n.complete})}},{key:"clear",value:function(){return this.dbPromise.then(function(t){var e=t.transaction("store","readwrite");return e.objectStore("store").clear(),e.complete})}}]),t}(),Dt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{status:"init",language:"english",photoViewer:"off",version:"v1.0.0"},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"setPhotoViewer":return Object(Z.a)({},t,{photoViewer:e.payload});case"setStatus":return Object(Z.a)({},t,{status:e.payload});default:return t}},Bt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{minWidth:360,maxWidth:2048,minHeight:540,maxHeight:1440,windowWidth:0,windowHeight:0,basicStyle:{width:0,height:0,display:"flex",flexFlow:"column nowrap",alignItems:"center"},styles:{container:{display:"flex",justifyContent:"center",alignItems:"center",backgroundSize:"100% 100%",flexShrink:0},area:{width:"100%",display:"flex",flexFlow:"row warp"},border:{borderStyle:"solid",borderWidth:"1px",borderColor:"#dddddd"},button:{backgroundColor:"transparent",border:"none",cursor:"pointer",backgroundSize:"100% 100%"}},colors:{green:"#91c33b",blue:"#2359a3",deepBlue:"#0a2647",textGrey:"#4a4a4a",lightGrey:"#dddddd"}},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"setDimension":var n=e.payload.width,i=e.payload.height,r=Object(Z.a)({},t.basicStyle,{width:n<t.minWidth?t.minWidth:n>t.maxWidth?t.maxWidth:.9999*n,height:i<t.minHeight?t.minHeight:i>t.maxHeight?t.maxHeight:.9999*i});return Object(Z.a)({},t,{windowWidth:n,windowHeight:i,basicStyle:r});default:return t}},Lt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{status:"off",english:"",chinese:"",simplified_chinese:"",button:"off",onConfirm:null,onCancel:null},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"confirm":var n=e.payload;return Object(Z.a)({},t,{status:"on",button:"confirm",onConfirm:n.onConfirm,onCancel:n.onCancel,english:n.message[0],chinese:n.message[1],simplified_chinese:n.message[2]});case"message":return Object(Z.a)({},t,{status:"on",button:"on",english:e.payload[0],chinese:e.payload[1],simplified_chinese:e.payload[2]});case"loadingMessage":return Object(Z.a)({},t,{status:"on",button:"off",english:e.payload[0],chinese:e.payload[1],simplified_chinese:e.payload[2]});case"hideModal":return Object(Z.a)({},t,{status:"off",button:"off"});default:return t}},Jt=n(43),Xt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{view:"",traces:[],subView:"",cachedUrl:{}},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"cacheUrl":var n=t.cachedUrl;return n[e.payload.filename]=e.payload.url,Object(Z.a)({},t,{cachedUrl:n});case"setSubView":return Object(Z.a)({},t,{subView:e.payload});case"backToHome":return Object(Z.a)({},t,{traces:t.traces.slice(0,1),view:t.traces[0]});case"clearView":return Object(Z.a)({},t,{traces:[],view:""});case"pullView":return 0===t.traces.length?t:Object(Z.a)({},t,{traces:t.traces.slice(0,t.traces.length-1),view:t.traces[t.traces.length-2]});case"pushView":return Object(Z.a)({},t,{traces:Object(Jt.a)(t.traces).concat([e.payload]),view:e.payload});default:return t}},Mt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:"",pw:"",type:"",createdAt:""},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"setUser":return e.payload;default:return t}},zt={updateElements:function(t,e,n,i){if(!e||0===e.length)return t;var r=t.slice(0);0===r.length&&(r=[e[0]]);for(var a=0;a<e.length;a++)if(e[a])for(var o=0;o<r.length;o++){if(!n&&r[o]._id===e[a]._id){r[o]=Object(Z.a)({},r[o],e[a]);break}if(n&&r[o]===e[a]){r[o]=e[a];break}if(o===r.length-1){i?r.splice(r.length,0,e[a]):r.splice(0,0,e[a]);break}}return r},getElementIndex:function(t,e){for(var n=0;n<t.length;n++)if(t[n]._id===e._id)return n}},Ht=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{reports:[],viewingReport:{},currentStage:0},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"setCurrentStage":var n=e.payload;return n<0||n>4?t:Object(Z.a)({},t,{currentStage:e.payload});case"viewReport":return Object(Z.a)({},t,{viewingReport:e.payload});case"updateReports":return Object(Z.a)({},t,{reports:zt.updateElements(t.reports,e.payload)});default:return t}},Qt=Object(j.c)({main:Dt,ui:Bt,modal:Lt,content:Xt,user:Mt,report:Ht}),Vt=(n(82),n(42)),Gt=null;Gt=Object(j.a)(function(t){return function(t){return function(e){try{t(e)}catch(n){console.log("error! ",n)}}}},Vt.a);var Pt=Object(j.d)(Qt,{},Gt);d.a.render(l.a.createElement(p.a,{store:Pt},l.a.createElement(Et,{db:new It})),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[44,2,1]]]);
//# sourceMappingURL=main.4e67465f.chunk.js.map